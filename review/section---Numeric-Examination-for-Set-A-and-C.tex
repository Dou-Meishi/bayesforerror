%% -*- coding: utf-8 -*-

\section{Numeric Examination for Set A and C}
对于首项近似下的 Set A，
应用 $\dmsdkp$ 的隐式表达式 Eq~\eqref{eq:DOBSetA}，
可以得到 PRC2015 TABLE.~II 的结果。
这里我们使用了函数 \inlinecode{scipy.optimize.root_scalar()}
来求得 $p\%>(p\%)_t$ 时的结果
(见~\href{https://github.com/Dou-Meishi/bayesforerror/blob/master/code/tab2.py}{\texttt{tab2.py}}).

对于首项近似下的 Set C，
可以应用公式 Eq~\eqref{eq:PrDelta1} 数值计算得到 $\dmspr(\dmsdeltako|
\dmsccck)$，
然后使用隐式表达式 Eq~\eqref{eq:DOB} 求出 $\dmsdkp$
(见~\href{https://github.com/Dou-Meishi/bayesforerror/blob/master/code/tab3-1.py}{\texttt{tab3-1.py}}).
结果见 \autoref{tab:tab3-1}.

对于不使用首项近似的情形，
可以从 Eq~\eqref{eq:PrDeltah} 出发。
观察发现，
数值计算 $\dmspr(\Delta|\dmsccck)$ 的难点就在于
$\dmspr_h(\Delta|\dmscbar)$，
除此之外都是简单的一重积分。
而只有 $\dmspr_h(\Delta|\dmscbar)$ 是通过对 $\dmsccch$ 的 $h$ 重积分给出的。
好在文献 PRC2017 APPENDIX~A 中给出了 Set A, B, C 对应 $\dmspr(c_n|\dmscbar)$
情形下 $\dmspr_h(\Delta|\dmscbar)$ 的简化表达式，
\begin{equation}
  \label{eq:PrhABC}
  \begin{aligned}
    \dmspr_h^{(A)}(\Delta|\dmscbar) &=
    \frac{1}{2\pi}\int_{-\infty}^{+\infty}
    \cos(t\Delta) \prod_{n=k+1}^{k+h}
    \frac{\sin( Q^nt\dmscbar)}{ Q^nt\dmscbar}\dmsdif t\\
    \dmspr_h^{(B)}(\Delta|\dmscbar) &= \dmspr_h^{(A)}(\Delta|\dmscbar) \\
    \dmspr_h^{(C)}(\Delta|\dmscbar) &=
    \frac{1}{q\dmscbar\sqrt{2\pi}}\exp\Bigl(- \frac{
        \Delta^2}{2q^2\dmscbar^2}\Bigr),
    \qquad q^2\equiv\sum_{n=k+1}^{k+h}Q^{2n}
    = Q^{2k+2} \frac{1-Q^{2h}}{1-Q^2}
  \end{aligned}
\end{equation}
这里 $\dmspr_h^{(A)}(\Delta|\dmscbar)=\dmspr_h^{(B)}(\Delta|\dmscbar)$
是因为 Set A, B 有相同概率分布的 $\dmspr(c_n|\dmscbar)$.

对于 Set C，
将 Eq~\eqref{eq:PrhABC} 代入 Eq~\eqref{eq:PrDeltah}，
并令 $x=1/\dmscbar$,
\begin{equation}
  \label{eq:52}
  \dmspr_h^{(C)}(\Delta|\dmsccck) = \frac{1}{q\sqrt{2\pi}}\cdot\frac{
    \int_{1/\dmscbar_>}^{1/\dmscbar_<}x^{n_c}\exp\biggl[- \frac{x^2}{2}\Bigl(
    \dmsccckb^2+\frac{\Delta^2}{q^2}\Bigr)\biggr]\dmsdif x}{
    \int_{1/\dmscbar_>}^{1/\dmscbar_<}x^{n_c-1}\exp\biggl(- \frac{
      x^2}{2}\dmsccckb^2\biggr)\dmsdif x},
  \qquad \dmsccckb^2\equiv\sum_{n=0}^k c_n^2
\end{equation}
利用特殊函数 $\upGamma\,(s,x)$，
可以计算出 Eq~\eqref{eq:52} 中分子分母的积分，
\begin{equation}
  \label{eq:upGammasx}
  \upGamma\,(s,x) = \int_x^\infty t^{s-1}e^{-t}\dmsdif t
\end{equation}
\begin{equation}
  \label{eq:53}
  \int_{1/\dmscbar_>}^{1/\dmscbar_<}x^{n_c-1}e^{-\alpha x^2}\dmsdif x
  = \frac{\alpha^{-n_c/2}}{2}
  \int_{\alpha/\dmscbar_>^2}^{\alpha/\dmscbar_<^2}
    t^{ \frac{n_c}{2}-1}e^{-t}\dmsdif t
  = \frac{\alpha^{-n_c/2}}{2}
  \Biggl[\upGamma\,\biggl( \frac{n_c}{2},
    \frac{\alpha}{\dmscbar_>^2}\biggr)
      - \upGamma\,\biggl( \frac{n_c}{2},
      \frac{\alpha}{\dmscbar_<^2}\biggr)\Biggr]
\end{equation}
\begin{equation}
  \label{eq:54}
  \int_{1/\dmscbar_>}^{1/\dmscbar_<}x^{n_c}e^{-\beta x^2}\dmsdif x
  = \frac{\beta^{-(n_c+1)/2}}{2}
  \int_{\beta/\dmscbar_>^2}^{\beta/\dmscbar_<^2}
    t^{ \frac{n_c+1}{2}-1}e^{-t}\dmsdif t
  = \frac{\beta^{-(n_c+1)/2}}{2}
  \Biggl[\upGamma\,\biggl( \frac{n_c+1}{2},
    \frac{\beta}{\dmscbar_>^2}\biggr)
      - \upGamma\,\biggl( \frac{n_c+1}{2},
      \frac{\beta}{\dmscbar_<^2}\biggr)\Biggr]
\end{equation}
Eq~\eqref{eq:54} 和 Eq~\eqref{eq:53} 的计算非常类似，
仅需要令 $n_c\mapsto n_c+1, \alpha\mapsto\beta$。
这里 $\alpha,\beta$ 定义为
\begin{equation}
  \label{eq:55}
  \alpha\equiv \frac{1}{2}\dmsccckb^2,
  \qquad
  \beta\equiv \frac{1}{2}\Bigl(\dmsccckb^2+ \frac{\Delta^2}{q^2}
  \Bigr)
\end{equation}

PRC2015 TABLE.~II, III 分别对应这里的
\autoref{tab:tab2}, \autoref{tab:tab3-1} 和 \autoref{tab:tab3-2}，
已将出现冲突的地方用颜色标出。
可以看出复现的结果只有少数几个点出现了小数点后一到两位的误差。
